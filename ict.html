<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Welcome To Glorious Schools, #1 Academic Giant in Ugandan Educational Sector.">
    <meta name="keyword"
        content="Glorious TV, educational videos, Schemes Of Work, Lesson Plans, Lesson Notes, Topical Questions, Luganda Translated Movies, Past Papers">
    <meta name="author" content="Fresh Teacher">
    <link rel="icon" type="image/png" sizes="16x16" href="schoologo-2-150x150.png">
    <link data-n-head="ssr" rel="manifest" href="/manifest.json" data-hid="manifest">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <meta property="og:site_name" content="Fresh Teacher's Library" />
    <meta property="og:image" content="https://gloriouschools.vercel.app/gallery.jpg" />
       <title>ICT Quiz</title>
    <style>
        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background-color: #f18900;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
        .quiz-container {
            background-color: #794500;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 600px;
            width: 90%;
        }
        h1 {
            color: #fdcf00;
            font-size: 2.5em;
            margin-bottom: 20px;
        }
        .selection-group {
            margin-bottom: 15px;
        }
        .selection-group label {
            display: block;
            color: #fdcf00;
            margin-bottom: 5px;
            font-size: 1.2em;
        }
        select {
            width: 80%;
            padding: 10px;
            margin: 5px 0;
            border-radius: 10px;
            border: 2px solid #4ecdc4;
            background-color: #fff;
            font-size: 1em;
            cursor: pointer;
        }
        select:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .question {
            font-size: 1.2em;
            margin-bottom: 20px;
            color: #fdcf00;
        }
        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        .option {
            background-color: #ff6f00;
            border: none;
            border-radius: 10px;
            padding: 15px;
            font-size: 1em;
            cursor: pointer;
            transition: transform 0.3s, background-color 0.3s;
            color: white;
        }
        .option:hover {
            transform: scale(1.02);
            background-color: #ffa73b;
        }
        .option.bounce {
            animation: bounce 0.5s;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-10px);}
            60% {transform: translateY(-5px);}
        }
        #startQuiz, #playAgain {
            padding: 10px 20px;
            background-color: #cb7000;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
            transition: background-color 0.3s;
        }
        #startQuiz:hover, #playAgain:hover {
            background-color: #ff8f00;
        }
        #startQuiz:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .hidden {
            display: none;
        }
        #result {
            font-size: 1.5em;
            font-weight: bold;
            margin: 20px 0;
            color: #fdcf00;
        }
        #processing {
            color: #fdcf00;
            margin: 20px 0;
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        #percentage {
            font-size: 2em;
            color: #fdcf00;
        }
        #scoreboard {
            margin-top: 20px;
            color: #fdcf00;
        }
        /* Updated scoreboard table styles */
        #scoreboard table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            border: 2px solid #ffda35;
        }

        #scoreboard th, 
        #scoreboard td {
            padding: 8px;
            text-align: left;
            border: 1px solid #fdcf00;
            color: #fdcf00;
        }

        #scoreboard th {
            background-color: rgba(255, 111, 0, 0.5);
            font-weight: bold;
            border-bottom: 2px solid #fdcf00;
        }

        #scoreboard tr:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        body {
    font-family: 'Comic Sans MS', cursive, sans-serif;
    background-color: #f18900;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    padding: 10px;
}

.quiz-container {
    background-color: #794500;
    border-radius: 20px;
    padding: 15px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    text-align: center;
    max-width: 600px;
    width: 95%;
    margin: 10px auto;
}

h1 {
    color: #fdcf00;
    font-size: 2em;
    margin-bottom: 15px;
}

.selection-group {
    margin-bottom: 15px;
}

.selection-group label {
    display: block;
    color: #fdcf00;
    margin-bottom: 5px;
    font-size: 1.1em;
}

select {
    width: 90%;
    padding: 10px;
    margin: 5px 0;
    border-radius: 10px;
    border: 2px solid #4ecdc4;
    background-color: #fff;
    font-size: 1em;
    cursor: pointer;
}

.question {
    font-size: 1.1em;
    margin-bottom: 15px;
    color: #fdcf00;
    padding: 0 10px;
}

.options {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-bottom: 15px;
    padding: 0 10px;
}

.option {
    background-color: #ff6f00;
    border: none;
    border-radius: 10px;
    padding: 12px 8px;
    font-size: 1em;
    cursor: pointer;
    transition: transform 0.3s, background-color 0.3s;
    color: white;
    white-space: normal;
    text-align: center;
}

/* Mobile-optimized table styles */
#scoreboard {
    margin-top: 20px;
    color: #fdcf00;
    overflow-x: auto;
}

#scoreboard table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
    background-color: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    min-width: 300px;
}

#scoreboard th, 
#scoreboard td {
    padding: 8px;
    text-align: left;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

#scoreboard th {
    background-color: rgba(255, 111, 0, 0.5);
    font-size: 0.9em;
}

#scoreboard td {
    font-size: 0.9em;
}

/* Mobile-specific adjustments */
@media (max-width: 480px) {
    h1 {
        font-size: 1.5em;
    }
    
    .quiz-container {
        padding: 10px;
        width: 98%;
    }
    
    .selection-group label {
        font-size: 1em;
    }
    
    select {
        width: 95%;
        padding: 8px;
    }
    
    .option {
        padding: 10px 6px;
        font-size: 0.9em;
    }
    
    .question {
        font-size: 1em;
    }
    
    #result {
        font-size: 1.2em !important;
        padding: 0 10px;
    }
    
    #scoreboard th, 
    #scoreboard td {
        padding: 6px;
        font-size: 0.85em;
    }
}

/* Ensure buttons are touch-friendly on mobile */
#startQuiz, 
#playAgain {
    padding: 12px 20px;
    font-size: 1em;
    min-width: 120px;
    margin: 10px auto;
}

@media (max-width: 480px) {
    #startQuiz, 
    #playAgain {
        padding: 10px 16px;
        font-size: 0.9em;
    }
}
/* Ensure table borders are visible on mobile */
@media (max-width: 480px) {
            #scoreboard table {
                border: 2px solid #e49100;
            }
            
            #scoreboard th, 
            #scoreboard td {
                border: 1px solid #f1ff32;
                padding: 6px;
            }
        }
        .modal-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 1000;
    align-items: center;
    justify-content: center;
}

.modal {
    background-color: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    max-width: 400px;
    width: 90%;
    position: relative;
    animation: modalSlideIn 0.3s ease-out;
}

@keyframes modalSlideIn {
    from {
        transform: translateY(-20px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.modal-header {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid #eee;
}

.modal-icon {
    margin-right: 10px;
    width: 24px;
    height: 24px;
}

.modal-title {
    font-size: 1.2em;
    font-weight: bold;
    margin: 0;
    color: #333;
}

.modal-content {
    margin-bottom: 20px;
    color: #666;
    line-height: 1.4;
}

.modal-buttons {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
}

.modal-button {
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 500;
    transition: background-color 0.2s;
}

.modal-button.primary {
    background-color: #4CAF50;
    color: white;
}

.modal-button.primary:hover {
    background-color: #45a049;
}

.modal-button.secondary {
    background-color: #f5f5f5;
    color: #333;
}

.modal-button.secondary:hover {
    background-color: #e8e8e8;
}

.modal-input {
    width: 100%;
    padding: 8px;
    margin-bottom: 15px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 1em;
}

.modal-input:focus {
    outline: none;
    border-color: #4CAF50;
    box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
}

.error-modal .modal-icon {
    color: #f44336;
}

.success-modal .modal-icon {
    color: #4CAF50;
}

.warning-modal .modal-icon {
    color: #ff9800;
}

.info-modal .modal-icon {
    color: #2196F3;
}
.question-counter {
    font-size: 1.1em;
    color: #666;
    margin-bottom: 15px;
    font-weight: 500;
    text-align: center;
}
.scoreboard-btn {
            background-color: #2196F3;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        .scoreboard-btn:hover {
            background-color: #1976D2;
        }

        .scoreboard-modal {
    /* Remove the duplicate display property */
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.15);
    z-index: 1000;
    max-width: 90%;
    width: 800px;
    max-height: 90vh;
    /* Move the flex properties to a separate class */
    flex-direction: column;
}

/* Add a new class for when the modal is visible */
.scoreboard-modal.visible {
    display: flex;
}

        .modal-backdrop {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 999;
            backdrop-filter: blur(2px);
        }

        .close-btn {
            position: absolute;
            right: 15px;
            top: 15px;
            cursor: pointer;
            font-size: 24px;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background-color: #f5f5f5;
            transition: background-color 0.3s;
        }

        .close-btn:hover {
            background-color: #e0e0e0;
        }

        .select-class {
            margin: 20px 0;
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            outline: none;
            transition: border-color 0.3s;
        }

        .select-class:focus {
            border-color: #2196F3;
        }

        /* Scoreboard table styles */
        #scoreboardContent {
            overflow-y: auto;
            max-height: calc(90vh - 160px);
            margin-top: 10px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }

        #scoreboardContent table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            table-layout: fixed;
        }

        #scoreboardContent thead {
            position: sticky;
            top: 0;
            background-color: #f5f5f5;
            z-index: 1;
        }

        #scoreboardContent th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #333;
            border-bottom: 2px solid #e0e0e0;
        }

        #scoreboardContent td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        /* Column widths */
        #scoreboardContent th:nth-child(1), 
        #scoreboardContent td:nth-child(1) {
            width: 10%;
            text-align: center;
        }

        #scoreboardContent th:nth-child(2), 
        #scoreboardContent td:nth-child(2) {
            width: 40%;
        }

        #scoreboardContent th:nth-child(3), 
        #scoreboardContent td:nth-child(3) {
            width: 30%;
        }

        #scoreboardContent th:nth-child(4), 
        #scoreboardContent td:nth-child(4) {
            width: 20%;
            text-align: right;
        }

        /* Zebra striping for rows */
        #scoreboardContent tbody tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        /* Hover effect on rows */
        #scoreboardContent tbody tr:hover {
            background-color: #f0f4f8;
        }

        /* Rank styling */
        .rank-1, .rank-2, .rank-3 {
            font-weight: bold;
        }

        .rank-1 {
            color: #ffd700; /* Gold */
        }

        .rank-2 {
            color: #c0c0c0; /* Silver */
        }

        .rank-3 {
            color: #cd7f32; /* Bronze */
        }

        /* Empty state message */
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #666;
            font-style: italic;
        }

        /* Responsive design */
        @media (max-width: 600px) {
            .scoreboard-modal {
                width: 95%;
                max-height: 95vh;
            }

            #scoreboardContent td, 
            #scoreboardContent th {
                padding: 10px 8px;
                font-size: 14px;
            }
        }
             /* Preview Modal Styles */
             .preview-btn {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        .preview-btn:hover {
            background-color: #45a049;
        }

        .preview-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            z-index: 1000;
            max-width: 90%;
            width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .preview-content {
            margin-top: 20px;
        }

        .question-preview {
            border-bottom: 1px solid #e0e0e0;
            padding: 15px 0;
        }

        .question-preview:last-child {
            border-bottom: none;
        }

        .question-number {
            font-weight: bold;
            color: #2196F3;
            margin-bottom: 8px;
        }

        .question-text {
            margin-bottom: 10px;
        }

        .option-preview {
            margin-left: 20px;
            padding: 4px 0;
            color: #666;
        }

        .correct-option {
            color: #4CAF50;
            font-weight: bold;
        }
          /* Animated Play Again Button Styles */
          #playAgain {
            background: linear-gradient(45deg, #2196F3, #1976D2);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
            animation: pulse 2s infinite;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
        }

        #playAgain:hover {
            transform: scale(1.05);
            animation: none;
            background: linear-gradient(45deg, #1976D2, #1565C0);
        }

        #playAgain::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 4px 20px rgba(33, 150, 243, 0.5);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
            }
        }

        @keyframes shine {
            0% {
                left: -50%;
                opacity: 0;
            }
            50% {
                opacity: 0.5;
            }
            100% {
                left: 100%;
                opacity: 0;
            }
        }
        .admin-controls {
    text-align: center;
    margin-top: 20px;
}

.button-group, .admin-controls {
    transition: display 0.3s ease;
}
    </style>
</head>
<body>
    <!-- Add this HTML at the end of your body tag -->
<div class="modal-overlay" id="modalOverlay">
    <div class="modal" id="modalContent">
        <div class="modal-header">
            <svg class="modal-icon" id="modalIcon" viewBox="0 0 24 24"></svg>
            <h3 class="modal-title" id="modalTitle"></h3>
        </div>
        <div class="modal-content" id="modalMessage"></div>
        <div class="modal-buttons" id="modalButtons"></div>
    </div>
</div>
    <div class="quiz-container">
        <h1>ICT TEST</h1>

    
            <!-- Add Preview Modal -->
            <div id="previewModal" class="preview-modal">
                <span class="close-btn" id="closePreview">&times;</span>
                <h2>Preview Questions</h2>
                <select id="previewClassSelect" class="select-class">
                    <option value="">Select a class</option>
                </select>
                <div id="previewContent" class="preview-content"></div>
            </div>
    
         <!-- Add Scoreboard Modal -->
         <div id="scoreboardModal" class="scoreboard-modal">
             <span class="close-btn" id="closeScoreboard">&times;</span>
             <h2>Class Scoreboard</h2>
             <select id="scoreboardClassSelect" class="select-class">
                 <option value="">Select a class</option>
             </select>
             <div id="scoreboardContent">
                 <table>
                     <thead>
                         <tr>
                             <th>Rank</th>
                             <th>Name</th>
                             <th>Stream</th>
                             <th>Score</th>
                         </tr>
                     </thead>
                     <tbody id="scoreboardModalBody"></tbody>
                 </table>
             </div>
         </div>
         <div id="modalBackdrop" class="modal-backdrop"></div>
 
        <!-- Player Selection Section -->
        <div id="playerSelection">
            <div class="selection-group">
                <label for="classSelect">Select Class:</label>
                <select id="classSelect">
                    <option value="">Choose a class</option>
                </select>
            </div>
            <div class="selection-group">
                <label for="streamSelect">Select Stream:</label>
                <select id="streamSelect" disabled>
                    <option value="">Choose a stream</option>
                </select>
            </div>
            <div class="selection-group">
                <label for="nameSelect">Select Name:</label>
                <select id="nameSelect" disabled>
                    <option value="">Choose your name</option>
                </select>
            </div>
            <button id="startQuiz" disabled>Start Quiz</button>
        </div>

                      <!-- Add Preview Button next to Scoreboard Button -->
                      <div class="button-group">
                        <button id="viewScoreboard" class="scoreboard-btn">View Scoreboard 📊</button>
                        <button id="previewQuestions" class="preview-btn">Preview Questions 📝</button>
                    </div>
        <!-- First, add this line to the quiz section in your HTML, just before the question div -->
<div id="quiz" class="hidden">
    <div class="question-counter" id="questionCounter">Question 1 of 20</div>
    <div class="question" id="question"></div>
    <div class="options" id="options"></div>
</div>


        <!-- Quiz Section -->
        <div id="quiz" class="hidden">
            <div class="question" id="question"></div>
            <div class="options" id="options"></div>
        </div>

        <!-- Processing Section -->
        <div id="processing" class="hidden">
            <div class="spinner"></div>
            <p>Calculating your score...</p>
            <div id="percentage">0%</div>
        </div>

        <!-- Result Section -->
        <div id="result" class="hidden"></div>

        <!-- Scoreboard Section -->
        <div id="scoreboard" class="hidden">
            <h2>Scoreboard</h2>
            <table>
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Name</th>
                        <th>Stream</th>
                        <th>Score</th>
                    </tr>
                </thead>
                <tbody id="scoreboardBody"></tbody>
            </table>
            <button id="playAgain">RETURN TO QUIZ 🔙</button>
        </div>
    </div>

    <script>
        // Add this function to control button visibility
        function toggleButtonGroup(show) {
    // Control scoreboard and preview buttons
    const buttonGroup = document.querySelector('.button-group');
    if (buttonGroup) {
        buttonGroup.style.display = show ? 'flex' : 'none';
    }
    
    // Control admin reset button
    const adminControls = document.querySelector('.admin-controls');
    if (adminControls) {
        adminControls.style.display = show ? 'block' : 'none';
    }
}

// Modify the startQuizButton click handler
document.addEventListener('DOMContentLoaded', () => {
    const startQuizButton = document.getElementById('startQuiz');
    
    startQuizButton.addEventListener('click', () => {
        if (hasUserAttemptedQuiz(selectedClass, selectedStream, selectedName)) {
            modal.show('warning', 'Quiz Already Attempted', 
                `${selectedName} has already completed this quiz!`, [
                    { text: 'OK', type: 'primary' }
                ]
            );
            return;
        }
        document.getElementById('playerSelection').classList.add('hidden');
        document.getElementById('quiz').classList.remove('hidden');
        // Hide the button group when starting quiz
        toggleButtonGroup(false);
        loadQuestion();
    });
});

         // Add this to your existing JavaScript
         document.addEventListener('DOMContentLoaded', () => {
            const previewBtn = document.getElementById('previewQuestions');
            const previewModal = document.getElementById('previewModal');
            const closePreview = document.getElementById('closePreview');
            const previewClassSelect = document.getElementById('previewClassSelect');
            const previewContent = document.getElementById('previewContent');

            // Populate preview class select
            Object.keys(questions).forEach(className => {
                const option = document.createElement('option');
                option.value = className;
                option.textContent = className;
                previewClassSelect.appendChild(option);
            });

            // Show preview modal
            previewBtn.addEventListener('click', () => {
                previewModal.style.display = 'block';
                document.getElementById('modalBackdrop').style.display = 'block';
            });

            // Hide preview modal
            closePreview.addEventListener('click', () => {
                previewModal.style.display = 'none';
                document.getElementById('modalBackdrop').style.display = 'none';
            });

            // Handle class selection for preview
            previewClassSelect.addEventListener('change', (e) => {
                const selectedClass = e.target.value;
                if (!selectedClass) {
                    previewContent.innerHTML = '<p>Please select a class to view questions</p>';
                    return;
                }

                const classQuestions = questions[selectedClass];
                previewContent.innerHTML = classQuestions.map((q, index) => `
                    <div class="question-preview">
                        <div class="question-number">Question ${index + 1}</div>
                        <div class="question-text">${q.question}</div>
                        ${q.options.map((option, optIndex) => `
                            <div class="option-preview ${optIndex === q.correctAnswer ? 'correct-option' : ''}">
                                ${String.fromCharCode(65 + optIndex)}. ${option}
                                ${optIndex === q.correctAnswer ? ' ✓' : ''}
                            </div>
                        `).join('')}
                    </div>
                `).join('');
            });

            // Close modal on backdrop click
            document.getElementById('modalBackdrop').addEventListener('click', () => {
                previewModal.style.display = 'none';
                document.getElementById('modalBackdrop').style.display = 'none';
            });

            // Close modal on Escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    previewModal.style.display = 'none';
                    document.getElementById('modalBackdrop').style.display = 'none';
                }
            });
        });

         // Function to show the scoreboard modal
         function showScoreboardModal() {
            document.getElementById('scoreboardModal').style.display = 'block';
            document.getElementById('modalBackdrop').style.display = 'block';
        }

        // Function to hide the scoreboard modal
        function hideScoreboardModal() {
            document.getElementById('scoreboardModal').style.display = 'none';
            document.getElementById('modalBackdrop').style.display = 'none';
        }

        // Function to populate scoreboard in modal
// Function to format rank with special styling for top performers
function formatRank(rank) {
    const rankEmojis = ['🥇', '🥈', '🥉'];
    return rank <= 3 ? `${rank} ${rankEmojis[rank - 1]}` : rank;
}

// Enhanced scoreboard population function
function populateModalScoreboard(className) {
    const scoreboardBody = document.getElementById('scoreboardModalBody');
    scoreboardBody.innerHTML = '';

    try {
        let scores = JSON.parse(localStorage.getItem(`quizScores_${className}`)) || [];
        
        // Handle empty scores
        if (scores.length === 0) {
            scoreboardBody.innerHTML = `
                <tr>
                    <td colspan="4" style="text-align: center; padding: 20px; color: #666;">
                        No scores available for ${className} yet
                    </td>
                </tr>`;
            return;
        }

        // Sort scores by highest first
        scores.sort((a, b) => b.score - a.score);

        scores.forEach((score, index) => {
            const row = scoreboardBody.insertRow();
            row.className = index % 2 === 0 ? 'even-row' : 'odd-row';

            // Rank cell with special formatting
            const rankCell = row.insertCell(0);
            rankCell.textContent = formatRank(index + 1);
            rankCell.className = `rank rank-${index + 1}`;
            
            // Name cell
            const nameCell = row.insertCell(1);
            nameCell.textContent = score.name.toUpperCase();
            nameCell.className = 'name-cell';
            
            // Stream cell
            const streamCell = row.insertCell(2);
            streamCell.textContent = score.stream;
            streamCell.className = 'stream-cell';
            
            // Score cell with color coding
            const scoreCell = row.insertCell(3);
            scoreCell.textContent = `${score.score}%`;
            scoreCell.className = 'score-cell';
            
            // Add color coding based on score
            if (score.score >= 80) {
                scoreCell.style.color = '#2e7d32'; // Green for excellent
            } else if (score.score >= 60) {
                scoreCell.style.color = '#1976d2'; // Blue for good
            } else if (score.score >= 40) {
                scoreCell.style.color = '#f57c00'; // Orange for average
            } else {
                scoreCell.style.color = '#c62828'; // Red for needs improvement
            }
        });
    } catch (error) {
        console.error('Error populating scoreboard:', error);
        scoreboardBody.innerHTML = `
            <tr>
                <td colspan="4" style="text-align: center; padding: 20px; color: #dc3545;">
                    Error loading scoreboard. Please try again.
                </td>
            </tr>`;
    }
}

// Initialize all scoreboard functionality
document.addEventListener('DOMContentLoaded', () => {
    // Initialize UI elements
    const viewScoreboardBtn = document.getElementById('viewScoreboard');
    const closeScoreboardBtn = document.getElementById('closeScoreboard');
    const modalBackdrop = document.getElementById('modalBackdrop');
    const scoreboardClassSelect = document.getElementById('scoreboardClassSelect');
    
    // Add loading state indicator
    const addLoadingState = () => {
        scoreboardBody.innerHTML = `
            <tr>
                <td colspan="4" style="text-align: center; padding: 20px;">
                    Loading scores... ⌛
                </td>
            </tr>`;
    };

    // Populate class select with available classes
    try {
        Object.keys(players).forEach(className => {
            const option = document.createElement('option');
            option.value = className;
            option.textContent = className;
            scoreboardClassSelect.appendChild(option);
        });
    } catch (error) {
        console.error('Error populating class select:', error);
        scoreboardClassSelect.innerHTML = '<option value="">Error loading classes</option>';
    }

    // Event Listeners
    viewScoreboardBtn.addEventListener('click', () => {
        showScoreboardModal();
        // Clear previous selection
        scoreboardClassSelect.value = '';
        scoreboardBody.innerHTML = `
            <tr>
                <td colspan="4" style="text-align: center; padding: 20px;">
                    Please select a class to view scores
                </td>
            </tr>`;
    });

    closeScoreboardBtn.addEventListener('click', hideScoreboardModal);
    modalBackdrop.addEventListener('click', hideScoreboardModal);
    
    // Handle class selection with loading state
    scoreboardClassSelect.addEventListener('change', (e) => {
        if (e.target.value) {
            addLoadingState();
            // Small delay to show loading state
            setTimeout(() => {
                populateModalScoreboard(e.target.value);
            }, 300);
        }
    });

    // Handle escape key to close modal
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            hideScoreboardModal();
        }
    });
});

  // Add to your DOMContentLoaded event listener
  document.addEventListener('DOMContentLoaded', () => {
            // [Previous initialization code remains]

            // Add resize listener for responsive height adjustment
            window.addEventListener('resize', adjustModalHeight);
            
            // Call once on initial load
            adjustModalHeight();
        });
        
        // Add this function to check if user has already taken the quiz
function hasUserAttemptedQuiz(className, streamName, userName) {
    const scores = JSON.parse(localStorage.getItem(`quizScores_${className}`)) || [];
    return scores.some(score => 
        score.name === userName && 
        score.stream === streamName && 
        score.class === className
    );
}

// Modal icons (SVG paths)
const MODAL_ICONS = {
    success: 'M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z',
    error: 'M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z',
    warning: 'M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z',
    info: 'M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z'
};

class CustomModal {
    constructor() {
        this.overlay = document.getElementById('modalOverlay');
        this.modal = document.getElementById('modalContent');
        this.icon = document.getElementById('modalIcon');
        this.title = document.getElementById('modalTitle');
        this.message = document.getElementById('modalMessage');
        this.buttons = document.getElementById('modalButtons');
    }

    show(type, title, message, buttons = []) {
        // Set icon
        this.icon.innerHTML = `<path d="${MODAL_ICONS[type]}" fill="currentColor"/>`;
        
        // Set modal type class
        this.modal.className = `modal ${type}-modal`;
        
        // Set title and message
        this.title.textContent = title;
        this.message.textContent = message;
        
        // Clear and add buttons
        this.buttons.innerHTML = '';
        buttons.forEach(button => {
            const btn = document.createElement('button');
            btn.className = `modal-button ${button.type || 'secondary'}`;
            btn.textContent = button.text;
            btn.onclick = () => {
                if (button.callback) button.callback();
                this.hide();
            };
            this.buttons.appendChild(btn);
        });
        
        // Show modal
        this.overlay.style.display = 'flex';
    }

    hide() {
        this.overlay.style.display = 'none';
    }

    prompt(title, message, callback) {
        // Set up prompt modal
        this.message.innerHTML = `
            ${message}
            <input type="password" id="modalInput" class="modal-input">
        `;
        
        this.show('info', title, '', [
            {
                text: 'Cancel',
                type: 'secondary',
                callback: () => this.hide()
            },
            {
                text: 'Submit',
                type: 'primary',
                callback: () => {
                    const input = document.getElementById('modalInput');
                    callback(input.value);
                }
            }
        ]);
    }
}

// Initialize modal
const modal = new CustomModal();

// Modified functions to use custom modal
function resetClassAttempts(className) {
    modal.prompt(
        'Admin Authentication',
        'Enter admin password to reset attempts:',
        (password) => {
            if (password === 'admin123') {
                localStorage.removeItem(`quizScores_${className}`);
                modal.show('success', 'Success', `All attempts for ${className} have been reset.`, [
                    { text: 'OK', type: 'primary' }
                ]);
                resetQuiz();
            } else {
                modal.show('error', 'Error', 'Incorrect admin password!', [
                    { text: 'Try Again', type: 'primary' }
                ]);
            }
        }
    );
}

const players = {
    'Primary Three': {
        'Sparrows': [ 
            'Musinguzi Harvey',
            'Namazzi Hilda', 
      'Abaasa Melisa', 
      'Naluyange Madrine', 
      'Namata Shifra K.', 
      'Nanyunja Rinah', 
      'Nakalungi Gabriella', 
      'Katumba Maria', 
      'Atuhaire Georgia', 
      'Treasure Elizabeth Seku', 
      'Namutebi Leona Rosella', 
      'Namugerwa Sabrina', 
      'Nampiima Pauline', 
      'Mirembe Raudah', 
      'Nyakato Edrinah', 
      'Amila Adams Kyeyune', 
      'Bwire Chloe Grighton', 
      'Akwero Lynne A.', 
      'Asaba Mulungi Joana', 
      'Nalubega Maria', 
      'Akamutuha Janet', 
      'Komujuni Fedrace', 
      'Namaganda Briannah', 
      'Musiime Gift', 
      'Muyama Abigail', 
      'Nabukenya Cate Josephine', 
      'Nalwanga Jazmine', 
      'Arinda Martha', 
      'Kavuma Norine Esther', 
      'Irene Malaika Nabbale', 
      'Namanda Majorine', 
      'Nabbongole Katrinah', 
      'Namujjuzi Winfred', 
      'Ainembabazi Melissa', 
      'Nansirumbi Isabella', 
      'Nakintu Immaculate', 
      'Ainembabazi Rainah Grace', 
      'Sanyu Nisha Gasaro', 
      'Barungi Victoria', 
      'Anviko Shantal', 
      'Malaika Trixie Kiyaga', 
      'Nansumbi Deborah', 
      'Ndagire Sarah',
  'Kalyango Raheem',
  'Wasswa Kabuye Jonah',
  'Kato Kabuye Jovans',
  'Agaba John Treasure',
  'Katumba Conrad',
  'Eloy Titus Ssentongo',
  'Ahumuza Praise Robert',
  'Kaweesa Keiran',
  'Balikuddembe Elvis',
  'Batanda Jethro',
  'Walusimbi Martin',
  'Kaweesi Hashim',
  'Ssewanyana Aaron',
  'Tamale John Francis',
  'Buyondo Israel',
  'Kwezi Robin',
  'Wodero Joshua',
  'Ssempijja Oscar',
  'Mukiriza George',
  'Kalibbala Akram',
  'Ariiho Israel',
  'KalyesubulanJayden',
  'Kakungulu Ryan Mark',
  'Ntambi Reagan J.',
  'Kimbugwe Abdullah'],
        'Cranes': [ 'Akampulira Calvin',
      'Bugembe Shakur',
      'Ankunda Donald',
      'Kisira Jordan',
      'Kibudde Nicholas',
      'Kagimu Shemaiah',
      'Keeya Malcom',
      'Kyeyune Daniel',
      'Lwasa Dalton',
      'Lwalanda Hakim',
      'Isingoma Edgar',
      'Magala Dalton',
      'Mukiibi Jonathan',
      'Mukisa Trajan',
      'Muwamba Wilfred',
      'Nkwisana Reagan',
      'Ssentongo Simon Elvis',
      'Ssimbwa Talia',
      'Walusimbi Jethro V.',
      'Hirwa Alle Ian',
      'Turyakira Tyrone',
      'Kafeero Elijah P',
      'Mugerwa Jericho',
      'Ssebuufu Raymond',
      'Ssekajigo Victor',
      'Bwiire Emmanuel',
      'Lubega Michael',
      'Kaweesi Abdul S.',
      'Tumusiime Frank',
      'Webare Gabriel',
      'Kaweesi Evans',
      'Kasule Eliasafu P.',
      'Sseruyange Timothy',
      'Migadde Shakur S.',
      'Sserunjogi Ethan',
      'Magumba Shakir',
      'Adriko Prosper',
      'Bukenya Krystal N.',
      'Besigye Tricia',
      'Byaruhanga Ashnaz',
      'Mukisa Favour',
      'Nakitto Rhonel R',
      'Nannungi Anna',
      'Namubiru Africa',
      'Nakiboneka Prudence',
      'Namagala Edron',
      'Nanyeza Lyan',
      'Namyalo Tasheemim',
      'Nakabuye Cynthia',
      'Nasasira Divine',
      'Nambejja Christine',
      'Nanjego Victoria',
      'Ola Keron',
      'Waikya Israella P',
      'Rashym Wahidah I.',
      'Nabukeera Shukran Y',
      'Nankubuge Shainah',
      'Nakasiisa Sheilah K.',
      'Namuyiga Jovia',
      'Nassimbwa Grace H',
      'Nakiguli Shivan Pia',
      'Nakalanzi Promise',
      'Kaitesi Leah',
      'Nassimbwa Ciara',
      'Kamugisha Giovana',
      'Mpairwe Celine L.',
      'Mwesigwa Milva',
      'Kiguli Nailor'],
        'Parrots': [ 'AGABA JOSHUA WALTER',
      'ASIIMWE DERRICK',
      'LUGENDO AMOS',
      'ATWIINE JOTHAM',
      'BATANDA DYLAN',
      'BYAMUKAMA KEITH',
      'TAMALE JAKIRA FLAVOUR',
      'KAKOOZA ABDUL RAZAQ',
      'KAKINDA FABIAN',
      'KATO JOLLY JONATHAN',
      'KAVUMA AMIR',
      'KAWEESA SIMPSON',
      'KIBUUKA RAYMOND',
      'KIMBUGWE STEWART',
      'KIMERA JONATHAN',
      'LUBOWA ABUBAKER',
      'LUKWAGO RAYAN',
      'MAGOMA BENHUR',
      'NSUBUGA MICHEAL',
      'SEKATE GODFREY',
      'SSALI MICHEAL',
      'SSEREMBA JEREMIAH',
      'WASSWA DAVID DOUGLAS',
      'MAYANJA VUUBI',
      'SSENYONGA JEREMIAH',
      'NAYEBARE TIMOTHY',
      'AKATUHEREZA MERRICK',
      'SSERUMAGGA JOHN PUTIN',
      'KAWUKI GIPSON',
      'KABAGAMBE WEISSMAN',
      'AINOMUGISHA PETRINAH',
      'AMPUMUZA ELIANAH',
      'ASINGUZA BRENDA',
      'AVGAIL BATZION',
      'KIZITO HANAH FRIEND',
      'KASULE ELSEN ZAWAD',
      'KATUSIIME JASMINE',
      'KISENYI MELLISA MAGGIE',
      'KYALIGONZA JOSEPHINE',
      'LUMU ANGEL FAVOUR',
      'LUTAAYA CATHERINE',
      'MAGOMA BELICIA',
      'NAKANWAGI KEIRAH',
      'NAKIMULI ETHEL',
      'NAMBALIRWA TRUDE',
      'NAMIREMBE MARIA NICOLE',
      'NAMUMBEJJA RYHAN',
      'NASSIWA HAILEY',
      'OKALLO NATASHA ESTHER',
      'NSIIMIRE FAITH',
      'SSEKATE NOELLA',
      'NAMULI COMFORT',
      'WANYENZE MARIANAH',
      'KALUNGI NEIRAH',
      'NANSUBUGA TRACY CAMILLA',
      'NAKIRIJJA CYNTHIA',
      'KYOMUHENDO GRACE',
      'SSENYONJO MERCY',
      'MUHINDO GIAN',
      'NIYIBIZI JERUSA',
      'NANYONGA ZIADAH',
      'MUNEZERO BLESSEN',
      'NANYONJO PATIENCE',
      'KYENYINI COSSILINE',
      'NAKASUMBA ANITAH',
      'NAMIREMBE PENINAH']
    },
    'Primary Four': {
        'Eaglets': [ 'KISAKYE MARTHA',
      'ANYANGO KAREN MERCY',
      'ASIIMWE MONICA',
      'ATUHAIRE ANGELLA',
      'BUKIRWA RAHMA DDUMBA',
      'JAMILAH PEACE ATHUMAN',
      'KATEREGGA RASHIM',
      'KAYAGA KATRINAH',
      'KEBIRUNGI DAISY EVE',
      'LUMU ANNA GRAGIOUS',
      'MUTESI TRINA TEDDY',
      'MUTUMBA AALIYAH',
      'NABAGULANYI TENDO TREASURE',
      'NABIRYE PRECIOUS',
      'NABUUMA VANESSA',
      'NAKIBUUKA ASSUMPTA',
      'NAKIBUULE MELAN BLESSED',
      'NAKITTO HAPPY DANIELLA',
      'NALUWOOZA BUSHIRAH',
      'NAMATOVU IMMACULATE',
      'NAMATOVU PROVIA ABIGAIL',
      'NAMBATYA SHIVAN',
      'NAMULINDWA VICTORIA',
      'NANTONGO SHANTEL',
      'TENDO HASIFA HAKIM',
      'UWINEZA SHAMAH ZINDUKA',
      'WASSAJJA MELISSA RAP',
      'MUTESAASIRA JOLLEN',
      'MUBIRU INAN',
      'NABBALE BLESSING V.',
      'MERCY ALLEN',
      'AVANI PATRICIA',
      'AHABWE ALVIN',
      'AINEBYONA ISAIAH',
      'AKOL LEON MASABA',
      'DDAMBA SHADRACK',
      'KAKANDE BLESSED',
      'KAWULUKUSI SHAKURAN',
      'KEVIN KHAMIS KENNEDY',
      'KIGOZI RAHEEM',
      'KITANDWE ABDULSHAKUL',
      'MATSIKO HANIF',
      'MAWEJJE UKASHA',
      'MIKKA TYABA NICHOLAS',
      'MUBIRU MIGUEL HERO',
      'MULUMBA FAVOUR CLINTON',
      'MULWANA NEAL',
      'NAMUTALE FEDERICO',
      'NSAMBA JORDAN RICH',
      'SSEJJUUKO PEDRO',
      'SSEKANJAKO ARAFAT',
      'SSETUMBA JESSIE',
      'TUSUUBIRA ARTHUR',
      'MBAZIRA JOEL',
      'MBABAZI CYROH',
      'MPANGA FAHAD',
      'RWOMUSHANA OMUGISHA G.'],
        'Bunnies': [  'BUKENYA KEITH MARTINS',
      'DDUMBA FRANCIS',
      'GITTA RAZAQ',
      'KASOZI NELSON',
      'KATEREGGA RAUL',
      'KAYEMBA SHAN',
      'KIMBUGWE MELVIN',
      'KIRABIRA ARNOLD',
      'KUTEESA ISMAIL KALULE',
      'LWANGA RAPHAEL',
      'MOYA ELISHA',
      'MUGISA VALENTE',
      'MUKISA NATHAN',
      'MUKISA SAMSON',
      'MULINDWA EDDY',
      'MURAMUZI JAN JENSEN',
      'NAJIB AL-SHAFIQ',
      'SSEKANDI RAMATHAN',
      'SSONKO HENRY ARTHUR',
      'WALUSIMBI ABDUL-SHARIK',
      'ANKUNDA DENISE',
      'ASIIMWE SHEENA',
      'ATAMBA CAROL JIREH',
      'ATUKUNDA GRAMIA',
      'AYEBAREYESU EXCELLENT',
      'BWIRE CLARRISA',
      'HIPAINGAH SALAH JOSEPHINE',
      'JIBE IMMACULATE',
      'KABANDA MARTHA',
      'KABUYAYA RAYANNA',
      'KALIBALA JANAT',
      'KAMUGISHA NATALIE',
      'KASEMIRE BLESSING',
      'KAVUMA GRACE',
      'KHARUNDA ESTHER',
      'KYAZZE MARTHA',
      'LYMIAH AVRIL SALIM',
      'MICHORO ANNA ALEXA',
      'NABAKOOZA CHRISTINE',
      'NABIKOLO ANNA',
      'NAKASUJJA SHANNAH',
      'NALUMANSI LYTON',
      'NAMALA SALSABEL',
      'NAMBI NAAVA',
      'NAMUBIRU RIAH',
      'NANDAWULA  DESIRE',
      'NANONO ROSHAN ISMAIL',
      'NINSIIMA KIRABO ARIANAH',
      'NYONYOZI EDRINAH',
      'UMUTESI DINAH INEZ',],
        'Cubs': [ 'AHEREZA HONOUR',
      'ALIYAH ADAMS K.',
      'AKARABO GOLDA',
      'BLESSING SHILOH',
      'AINOMUGISHA ANGEL',
      'KEMIGISHA ALEXANDRIA',
      'LUBUULWA MELINA J',
      'MUBEEZI SHADIA L.',
      'NAKUNGU PRECIOUS',
      'NASSANGA MARIA A.',
      'NAMIREMBE ALPHA',
      'NANUNGI DRUCILLA L.',
      'NAMAGANDA IMRAH',
      'NAKAWEESI MICHELLE',
      'NAMUTEBI GERTRUDE',
      'NANJOBE VANESSA',
      'NINSIIMA MARY S.',
      'NVANUNGI SHANIEZ F.',
      'TEMITOPE GRACE A.',
      'ASHABA ELIZABETH',
      'NANSUBUGA MANUELLA',
      'NAMAKULA SOPHIA',
      'OBANG SHALLOM S.',
      'BUKIRWA LETICIA',
      'KISMART DAUDA',
      'KASOZI AAMRAT',
      'NANTONGO BUSHIRAH',
      'MOKHTA ADAM SALAM',
      'BAGONZA JOAB',
      'KAYONGO JAWAD',
      'KAKONA JORDAN',
      'KIGGUNDU LUKE',
      'BUYUNGO ERIC',
      'LUBEGA MALCOM',
      'LUKANDWA PHILLIP',
      'MURUNGI IAN',
      'MUYINZA CYRUS',
      'MULANGIRA JOSEPH',
      'MANZI EVANS',
      'ITAAGA NICHOLAST',
      'LUYIGA  RAYAN',
      'SSEWAKIRYANGA HOSEA',
      'SSUUNA RAFAN W',
      'SSEMATIMBA MARK',
      'SSEBABENGA KERON',
      'TWESIGYE ADRIAN',
      'WALLIGO ETHAN',
      'NAMWANJA JOHN BAPTIST',
      'SSENGENDO PRITA',
      'KALULE CARLOS',
      'MUHUMUZA ADHELITO',
      'LUGGYA AKRAM',
      'SSEMOMBWE ANDERSON']
    },
    'Primary Five': {
        'Sunset': [  'AHABWE JOSIAH',
    'AMUGE LYNDSEY MILES',
    'ATULINDA AISHA',
    'AYEBARE MELLISA',
    'BATARINGAYA SHIMARO',
    'BUKIRWA SHAMRA DDUMBA',
    'BULEGA PIUS',
    'JAZMINE BIDS',
    'JJAGWE JOVAN',
    'JJUMBA ANGELLO',
    'KAKOOZA DIVINE MACKYLA',
    'KALUNGI JONATHAN',
    'KAREMERA ABDUL HANAN',
    'KATENDE HAMIR',
    'KATONO ALLAN',
    'KAZIBA JOSHUA',
    'KIGGUNDU LIA',
    'KIMBUGWE HASSAN AWADH',
    'KIRABO EVAS',
    'KIZZA JOYCE MYER SEMPA',
    'KYALIGONZA HARVEY RENATAH',
    'LUBWAMA MARTIN WASSWA',
    'LUKWAGO LUCKY AHMET',
    'LWANGA WYCLIFF',
    'MAKIKA MEEKSON',
    'MUBIRU RAJAB',
    'MUKISA PHILEMON',
    'MULWANA JONATHAN',
    'MUSASIZI ADRIAN',
    'MUWONGE PENIEL',
    'MWEBAZA PEACE DIVINE',
    'NABWIRE GLORIA MICHELLE',
    'NAGAWA ANTHONIA BEATRICE',
    'NAKAWEKE JANE',
    'NAKITTO MYRA REMEDY',
    'NAKIYEMBA SHUKRAH',
    'NAMAGANDA JULIANA TENDO',
    'NAMARA REBECCA BLESSED',
    'NAMAWEJJE ELIZABETH SHANTAL',
    'NAMIREMBE KAHLAN MARTHA',
    'NAMPIJJA PATRICIA',
    'NAMUGENYI HELLEN',
    'NAMUSISI MARIA FEDERESI',
    'NAMWANJE MACRINAH',
    'NANYONJO HALIMAH',
    'NASSUUNA WILDER',
    'NYIRANEZA VIVIAN',
    'ODONG DAVID ISA',
    'OPIO DANIEL OPOLOT',
    'OWARUHANGA JONATHAN KAHIIRWA',
    'SSERUNKUMA ABRIELLE PROSPER',
    'TUMUSIIME ELIJAH'  ],
        'Skyhigh': [   'ABAHO FARRELL',
    'AINEMBABAZI ELIANAH',
    'AMAANI JEHEL KAISER',
    'ARIHO CALVIN',
    'ATUHAIRE COMFORT',
    'ATUHAIRE PROMISE',
    'ATWIINE RUTH',
    'AYEBALE ABORIGINE',
    'BUGANZA PATIENCE',
    'BUKENYA HENRY SHADRACK',
    'ELIANA TREASURE MUKISA',
    'KABUYAYA TATIANA',
    'KAKOOZA JUMA KAGGWA',
    'KAYONDO MUSA HASHIM',
    'KIDHUUDO PATRICIA GLADYS',
    'KIMBUGWE TIMOTHY',
    'KISAWUZI PROSPER JONATHAN',
    'KIWANA GENEROUS SHAKRAN',
    'KIYAGA TERRY ELIJAH',
    'KIZITO ISAIAH',
    'KYAZZE MARIA',
    'LUBOWA SHANITAH',
    'LUBUULWA MELLISA',
    'LUZZE MARK IBRAHIM',
    'MAGOMA BENSON',
    'MURUNGI BETTINAH',
    'MURUNGI SHAREEF RAUSHAN',
    'MUTANDA LEON ARTHUR',
    'MUWANGUZI JEREMIAH ANKUNDA',
    'NAJJINGO TEOPISTA KALUNGI',
    'NAKANDI ROCINTA',
    'NAKINTU RAMLAH',
    'NAKYANZI BENINA',
    'NAMATA DIVINE HANNAH',
    'NAMITALA TONNIA',
    'NAMUTEBI LETICIA',
    'NAMYALO CLARA KETRA',
    'NANKYA NUSRAH',
    'NANOZI KEISHA',
    'NANTUME JAZMINE',
    'NDAGIRE SALMAH ALYSON',
    'NSUBUGA ERON',
    'NSUBUGA MATILDA YULLIANA',
    'OMAR ROSHEEN NSEGIMAANA',
    'PARA PATRINA',
    'RUGUMAYO JOSEPH REMIGIUS',
    'SANGA FAITH LISA',
    'SSEKATAWA CLANCY CALVIN',
    'SSENYONJO SEAN ADRIAN',
    'TALIDDA SARAH',
    'WALUGEMBE JONATHAN',
    'WAMALA CHESTNUT',
    'YIGA INNOCENT'],
        'Sunrise': [    'ADITE DIRAN',
    'AKATUSIIMA RAVEN',
    'ANZOA JOVANNAH',
    'ATURINDA KELTON',
    'BALUKU ELEUTHERIUS BROGAN',
    'BUGINGO JORAM',
    'BYEGANJE JOSEMARY ROVINSAH',
    'ITUNGO ISOBEL AYETA',
    'KAAZA JEMIMAH',
    'KABISWA ISAAC',
    'KALUNGI DAVID',
    'KASULE GORDON',
    'KATUMBA MARTHA',
    'KIRABO MADRINE PRINCESS',
    'KIWENDO CALVIN',
    'KYOMUGISHA ETHEL HANNAH',
    'LUYIGA RAHIM',
    'MAYITTO CHRISTIAN',
    'MIREMBE GIFT REBECCA',
    'MIRIMU ELIJAH',
    'MUGARURA PAXTON',
    'MUGENYI RYAN',
    'MUKIIBI JOSEPH',
    'MUKISA JEFFRON',
    'MUKISA SHAMMAH',
    'MURUNGI AARON',
    'MUSIIMENTA HANNAH AMITO',
    'MUTEBI JORDAN DIEGO',
    'MUWANGUZI ETHAN',
    'NABACHWA SHIVAN',
    'NABUKENYA TYRA',
    'NAJJINGO RHONITAH LUCY',
    'NAKAWUKI RIANAH',
    'NAKAYENGA MARY KATEREGGA',
    'NAKIBUULE SHEENAH',
    'NAKIJJE PRISCA RESTY',
    'NAKIMERA MARIA',
    'NAKIMULI KATRINAH PEACE',
    'NAMAGANDA LUISA JOY',
    'NAMMANDA HAIFA',
    'NANGENDO GABRIELLA',
    'NANSAMBA ESTHER',
    'NASSAAZI JACINTA KIZZA',
    'NATYABA EVELYN TENDO',
    'NAYIGA SHUDAT ZAHARA',
    'NYANZI RAYAN',
    'OSINDE AHMED',
    'SSAAZI RAPHEAL',
    'SSENDAGI SOLOMON',
    'SSENUNGI TITUS',
    'SSERUGO ASHLEY',
    'YEBETE MARY SADAD ELIAS']
    }
};

const questions = {
    'Primary Three': [
        {
            question: "What is a computer?",
            options: ["A toy", "An electronic device that stores and processes data into information", "A book", "A phone"],
            correctAnswer: 1
        },
        {
            question: "Which of these helps you see things on a computer?",
            options: ["Speaker", "Monitor", "Keyboard", "Mouse"],
            correctAnswer: 1
        },
        {
            question: "What do we use to print something from a computer?",
            options: ["Monitor", "Mouse", "Printer", "Keyboard"],
            correctAnswer: 2
        },
        {
            question: "Which object helps us point and click?",
            options: ["Mouse", "Keyboard", "Screen", "Speaker"],
            correctAnswer: 0
        },
        {
            question: "What do we call the buttons we press to type?",
            options: ["Screen buttons", "Mouse buttons", "Keyboard keys", "Computer buttons"],
            correctAnswer: 2
        },
        {
            question: "Which part of the computer shows us pictures and words?",
            options: ["Mouse", "Monitor", "Keyboard", "Printer"],
            correctAnswer: 1
        },
        {
            question: "What do we use to move the cursor on the screen?",
            options: ["Monitor", "Keyboard", "Mouse", "Printer"],
            correctAnswer: 2
        },
        {
            question: "What part of the computer helps us listen to music?",
            options: ["Monitor", "Speaker", "Keyboard", "Mouse"],
            correctAnswer: 1
        },
        {
            question: "Which part of the computer acts as its brain?",
            options: ["Monitor", "CPU", "Mouse", "Printer"],
            correctAnswer: 1
        },
        {
            question: "What is the case that holds all the important parts of a computer?",
            options: ["Mouse", "Monitor", "System Unit", "Printer"],
            correctAnswer: 2
        },
        {
            question: "Which part of the computer helps us input data using letters and numbers?",
            options: ["Monitor", "Keyboard", "Mouse", "CPU"],
            correctAnswer: 1
        },
        {
            question: "Which part of the computer helps to display words and images?",
            options: ["Speaker", "Monitor", "Keyboard", "Mouse"],
            correctAnswer: 1
        },
        {
            question: "Which part of the computer prints out papers?",
            options: ["Printer", "Monitor", "Keyboard", "Mouse"],
            correctAnswer: 0
        },
        {
            question: "What part of the computer do we click to select things?",
            options: ["Keyboard", "Mouse", "Monitor", "Speaker"],
            correctAnswer: 1
        },
        {
            question: "Which part of the computer helps you record sound?",
            options: ["Keyboard", "Mouse", "Microphone", "Monitor"],
            correctAnswer: 2
        },
        {
            question: "Which part of the computer is needed to hear sound?",
            options: ["CPU", "Mouse", "Monitor", "Speaker"],
            correctAnswer: 3
        },
      
        {
            question: "What is the main purpose of a computer?",
            options: ["To cook food", "To store and process data into meaningful information", "To clean the house", "To watch TV"],
            correctAnswer: 1
        },
        {
            question: "Where can you find computers in a school?",
            options: ["Classroom", "Library", "Computer lab", "Playground"],
            correctAnswer: 2
        },
        {
            question: "Which place uses computers to teach lessons online?",
            options: ["Zoo", "Playground", "School", "Park"],
            correctAnswer: 2
        },
        {
            question: "What is one disadvantage of using computers for too long?",
            options: ["It makes you very strong", "It can hurt your eyes", "It helps you run fast", "It makes you smarter"],
            correctAnswer: 1
        },

    ],
    'Primary Four': [
    {
            question: "Which part of the computer does most of the thinking?",
            options: ["Monitor", "CPU", "Mouse", "Printer"],
            correctAnswer: 1
        },
    {
            question: "What is the role of antivirus software?",
            options: ["Draw pictures", "Protect the computer from viruses", "Play music", "Write documents"],
            correctAnswer: 1
        },
        {
            question: "What does 'ICT' stand for?",
            options: ["Information and Computer Technology", "Internet and Communication Technology", "Information and Communication Technology", "International Computer Tools"],
            correctAnswer: 2
        },
        {
            question: "Which of these is an output device?",
            options: ["Keyboard", "Monitor", "Mouse", "Microphone"],
            correctAnswer: 1
        },
        {
            question: "What does CPU stand for?",
            options: ["Central Processing Unit", "Computer Power Unit", "Central Program Unit", "Computer Processing Unit"],
            correctAnswer: 0
        },
        {
            question: "Which keyboard shortcut is used to undo a mistake?",
            options: ["Ctrl + Z", "Ctrl + X", "Ctrl + V", "Ctrl + P"],
            correctAnswer: 0
        },
        {
            question: "Which software is used to type documents?",
            options: ["Windows", "Microsoft Word", "Google Chrome", "Adobe Photoshop"],
            correctAnswer: 1
        },
        {
            question: "What does 'ROM' stand for?",
            options: ["Random Only Memory", "Read Online Memory", "Read Only Memory", "Run On Memory"],
            correctAnswer: 2
        },
        {
            question: "Which key combination is used to paste text?",
            options: ["Ctrl + C", "Ctrl + P", "Ctrl + V", "Ctrl + S"],
            correctAnswer: 2
        },
        {
            question: "Which part of the computer processes all instructions?",
            options: ["Hard Drive", "CPU", "Monitor", "Keyboard"],
            correctAnswer: 1
        },
        {
            question: "What does 'WWW' stand for in a web address?",
            options: ["World Web Window", "Wide Web World", "World Wide Web", "Web Wide Window"],
            correctAnswer: 2
        },
        {
            question: "Which keyboard shortcut is used to print a document?",
            options: ["Ctrl + P", "Ctrl + V", "Ctrl + Z", "Ctrl + C"],
            correctAnswer: 0
        },
        {
            question: "Which of these is an example of an input device?",
            options: ["Monitor", "Mouse", "Printer", "Speaker"],
            correctAnswer: 1
        },
        {
            question: "Which program is used to browse the internet?",
            options: ["Microsoft Word", "Google Chrome", "Adobe Reader", "Windows Media Player"],
            correctAnswer: 1
        },
        {
            question: "What does 'RAM' stand for?",
            options: ["Random Available Memory", "Ready Access Memory", "Random Access Memory", "Running Access Memory"],
            correctAnswer: 2
        },
        {
            question: "Which key combination is used to select all text in a document?",
            options: ["Ctrl + A", "Ctrl + C", "Ctrl + V", "Ctrl + P"],
            correctAnswer: 0
        },
        {
            question: "What is an example of an operating system?",
            options: ["Windows 10", "Microsoft Excel", "Google Chrome", "Printer"],
            correctAnswer: 0
        },
        {
            question: "Which device allows you to move items on the screen?",
            options: ["Monitor", "Keyboard", "Mouse", "Hard Drive"],
            correctAnswer: 2
        },
        {
            question: "Which part of the computer holds temporary memory?",
            options: ["Hard Drive", "Monitor", "RAM", "Keyboard"],
            correctAnswer: 2
        },
        {
            question: "What is the main purpose of the 'Ctrl + S' keyboard shortcut?",
            options: ["To paste", "To save", "To print", "To select all"],
            correctAnswer: 1
        }
    ],
    'Primary Five': [
        {
            question: "Which part of the computer is considered the 'brain'?",
            options: ["Hard Drive", "CPU", "Monitor", "Keyboard"],
            correctAnswer: 1
        },
        {
            question: "What does 'HTML' stand for?",
            options: ["Hyper Text Makeup Language", "Hyperlinks and Text Markup Language", "Hyper Tool Machine Language", "Hyper Text Markup Language"],
            correctAnswer: 3
        },
        {
            question: "Which type of memory is permanent and non-volatile?",
            options: ["RAM", "Hard Drive", "ROM", "Cache"],
            correctAnswer: 2
        },
        {
            question: "Which device is used to capture live images on a computer?",
            options: ["Printer", "Monitor", "Scanner", "Webcam"],
            correctAnswer: 3
        },
        {
            question: "What does 'IP' in 'IP address' stand for?",
            options: ["Internet Process", "Internal Protocol", "Internet Protocol", "Input Process"],
            correctAnswer: 2
        },
        {
            question: "Which software is used to create presentations?",
            options: ["Microsoft Word", "Google Chrome", "Microsoft PowerPoint", "Adobe Photoshop"],
            correctAnswer: 2
        },
        {
            question: "What does 'USB' stand for?",
            options: ["Universal System Bus", "Universal Serial Bus", "Universal Software Bus", "Unified Serial Bus"],
            correctAnswer: 1
        },
        {
            question: "Which type of software is an operating system?",
            options: ["Microsoft Excel", "Windows 10", "Adobe Reader", "Google Chrome"],
            correctAnswer: 1
        },
        {
            question: "What does the 'Ctrl + F' keyboard shortcut do?",
            options: ["Find a word or phrase", "Open a file", "Copy text", "Save a file"],
            correctAnswer: 0
        },
        {
            question: "Which of these is NOT an input device?",
            options: ["Mouse", "Monitor", "Keyboard", "Microphone"],
            correctAnswer: 1
        },
        {
            question: "What does 'URL' stand for?",
            options: ["Universal Resource Locator", "Uniform Resource Locator", "Unified Response Link", "Universal Router Link"],
            correctAnswer: 1
        },
        {
            question: "Which keyboard shortcut is used to refresh a webpage?",
            options: ["Ctrl + S", "F5", "Ctrl + P", "Alt + F4"],
            correctAnswer: 1
        },
        {
            question: "Which part of the computer connects all other components together?",
            options: ["Motherboard", "CPU", "RAM", "Hard Drive"],
            correctAnswer: 0
        },
        {
            question: "What is the function of a router?",
            options: ["Store data", "Connect networks", "Display information", "Control sound"],
            correctAnswer: 1
        },
        {
            question: "What is the purpose of a firewall in computing?",
            options: ["To store data", "To print documents", "To protect a network", "To increase speed"],
            correctAnswer: 2
        },
        {
            question: "What does 'PDF' stand for?",
            options: ["Printed Data Form", "Portable Document File", "Portable Data Format", "Portable Document Format"],
            correctAnswer: 3
        },
        {
            question: "Which of these is an example of system software?",
            options: ["Microsoft Word", "Google Chrome", "Windows 10", "Adobe Reader"],
            correctAnswer: 2
        },
        {
            question: "What is the main purpose of a 'Cache' in a computer?",
            options: ["Store temporary data", "Store permanent data", "Process instructions", "Control power"],
            correctAnswer: 0
        },
        {
            question: "What does 'LAN' stand for?",
            options: ["Local Area Network", "Large Access Network", "Local Application Network", "Long Area Network"],
            correctAnswer: 0
        },
        {
            question: "What is the purpose of a computer's power supply?",
            options: ["Store data", "Run applications", "Provide electrical power", "Connect devices"],
            correctAnswer: 2
        }
    ]
};

let currentQuestion = 0;
let score = 0;
let selectedClass = '';
let selectedStream = '';
let selectedName = '';

// Audio context for sound effects
const audioContext = new (window.AudioContext || window.webkitAudioContext)();

function playSound(frequency, duration) {
    const oscillator = audioContext.createOscillator();
    const gainNode = audioContext.createGain();

    oscillator.type = 'sine';
    oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
    oscillator.connect(gainNode);
    gainNode.connect(audioContext.destination);

    gainNode.gain.setValueAtTime(0, audioContext.currentTime);
    gainNode.gain.linearRampToValueAtTime(0.5, audioContext.currentTime + 0.01);
    gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + duration);

    oscillator.start();
    oscillator.stop(audioContext.currentTime + duration);
}

function playSoundEffect(type) {
    switch (type) {
        case 'correct':
            playSound(800, 0.1);
            setTimeout(() => playSound(1000, 0.1), 100);
            break;
        case 'incorrect':
            playSound(300, 0.2);
            break;
        case 'finish':
            playSound(523.25, 0.1);  // C5
            setTimeout(() => playSound(659.25, 0.1), 100);  // E5
            setTimeout(() => playSound(783.99, 0.1), 200);  // G5
            setTimeout(() => playSound(1046.50, 0.2), 300);  // C6
            break;
    }
}

function initializeSelectors() {
    const classSelect = document.getElementById('classSelect');
    const streamSelect = document.getElementById('streamSelect');
    const nameSelect = document.getElementById('nameSelect');
    
    // Populate class select
    Object.keys(players).forEach(className => {
        const option = document.createElement('option');
        option.value = className;
        option.textContent = className;
        classSelect.appendChild(option);
    });

    // Class selection handler
    classSelect.addEventListener('change', (e) => {
        selectedClass = e.target.value;
        streamSelect.innerHTML = '<option value="">Choose a stream</option>';
        nameSelect.innerHTML = '<option value="">Choose your name</option>';
        
        if (selectedClass) {
            streamSelect.disabled = false;
            Object.keys(players[selectedClass]).forEach(streamName => {
                const option = document.createElement('option');
                option.value = streamName;
                option.textContent = streamName;
                streamSelect.appendChild(option);
            });
        } else {
            streamSelect.disabled = true;
            nameSelect.disabled = true;
        }
        updateStartButton();
    });

    // Stream selection handler
    streamSelect.addEventListener('change', (e) => {
        selectedStream = e.target.value;
        nameSelect.innerHTML = '<option value="">Choose your name</option>';
        
        if (selectedStream) {
            nameSelect.disabled = false;
            players[selectedClass][selectedStream].forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                nameSelect.appendChild(option);
            });
        } else {
            nameSelect.disabled = true;
        }
        updateStartButton();
    });

 
}

// Modify the updateStartButton function to check for previous attempts
function updateStartButton() {
    const startQuizButton = document.getElementById('startQuiz');
    
    // Reset button to default state first
    startQuizButton.disabled = true;
    startQuizButton.className = 'start-button'; // Add base class for styling
    
    if (selectedClass && selectedStream && selectedName) {
        if (hasUserAttemptedQuiz(selectedClass, selectedStream, selectedName)) {
            startQuizButton.textContent = '❌ Quiz Already Completed';
            startQuizButton.className += ' completed';
            startQuizButton.style.backgroundColor = '#ffcdd2';
            startQuizButton.style.color = '#d32f2f';
            startQuizButton.style.border = '2px solid #ef5350';
            startQuizButton.style.cursor = 'not-allowed';
        } else {
            startQuizButton.disabled = false;
            startQuizButton.textContent = '▶️ Start Quiz';
            startQuizButton.className += ' ready';
            startQuizButton.style.backgroundColor = '#4CAF50';
            startQuizButton.style.color = 'white';
            startQuizButton.style.border = '2px solid #45a049';
            startQuizButton.style.cursor = 'pointer';
            startQuizButton.style.transform = 'scale(1)';
            // Add hover effect
            startQuizButton.onmouseover = () => {
                startQuizButton.style.backgroundColor = '#45a049';
                startQuizButton.style.transform = 'scale(1.05)';
            };
            startQuizButton.onmouseout = () => {
                startQuizButton.style.backgroundColor = '#4CAF50';
                startQuizButton.style.transform = 'scale(1)';
            };
        }
    } else {
        startQuizButton.textContent = '⏳ Select Required Fields';
        startQuizButton.style.backgroundColor = '#f5f5f5';
        startQuizButton.style.color = '#757575';
        startQuizButton.style.border = '2px solid #bdbdbd';
        startQuizButton.style.cursor = 'not-allowed';
        startQuizButton.onmouseover = null;
        startQuizButton.onmouseout = null;
    }
    
    // Common styles
    startQuizButton.style.padding = '12px 24px';
    startQuizButton.style.borderRadius = '8px';
    startQuizButton.style.fontWeight = 'bold';
    startQuizButton.style.transition = 'all 0.3s ease';
    startQuizButton.style.boxShadow = '0 2px 4px rgba(0,0,0,0.2)';
}

// Modified loadQuestion function
function loadQuestion() {
    const questionElement = document.getElementById('question');
    const optionsElement = document.getElementById('options');
    const counterElement = document.getElementById('questionCounter');
    const classQuestions = questions[selectedClass];
    
    // Update the question counter
    counterElement.textContent = `Question ${currentQuestion + 1} of 20`;
    
    questionElement.textContent = classQuestions[currentQuestion].question;
    optionsElement.innerHTML = '';
    
    classQuestions[currentQuestion].options.forEach((option, index) => {
        const button = document.createElement('button');
        button.textContent = option;
        button.classList.add('option');
        button.addEventListener('click', () => selectAnswer(index));
        optionsElement.appendChild(button);
    });
}

// Modified selectAnswer function
function selectAnswer(answerIndex) {
    const classQuestions = questions[selectedClass];
    const correct = answerIndex === classQuestions[currentQuestion].correctAnswer;
    
    if (correct) {
        score += 5; // Each correct answer gives 5 marks
        playSoundEffect('correct');
    } else {
        playSoundEffect('incorrect');
    }

    const options = document.querySelectorAll('.option');
    options[answerIndex].style.backgroundColor = correct ? '#66bb6a' : '#ef5350';
    options[answerIndex].classList.add('bounce');

    setTimeout(() => {
        currentQuestion++;
        if (currentQuestion < 20) { // Changed to 20 questions
            loadQuestion();
        } else {
            showProcessing();
        }
    }, 1000);
}

function showProcessing() {
    document.getElementById('quiz').classList.add('hidden');
    document.getElementById('processing').classList.remove('hidden');
    
    let percentage = 0;
    const percentageElement = document.getElementById('percentage');
    const finalScore = score; // score is now out of 100 (20 questions × 5 marks)
    
    function incrementPercentage() {
        if (percentage < finalScore) {
            // Calculate smaller increments to avoid overshooting
            const remaining = finalScore - percentage;
            const increment = Math.min(
                Math.floor(Math.random() * 3) + 1, // Smaller random increments
                remaining // Never increment more than what's remaining
            );
            
            percentage += increment;
            percentageElement.textContent = percentage + '%'; // Direct percentage since total is now 100
            
            const delay = Math.random() < 0.3 ? Math.random() * 500 + 250 : Math.random() * 100 + 50;
            setTimeout(incrementPercentage, delay);
        } else {
            setTimeout(showResult, 1000);
        }
    }
    
    incrementPercentage();
}

// Modified saveScore function to store all relevant information
function saveScore(score) {
    let scores = JSON.parse(localStorage.getItem(`quizScores_${selectedClass}`)) || [];
    scores.push({
        name: selectedName,
        class: selectedClass,
        stream: selectedStream,
        score: score,
        date: new Date().toISOString()
    });
    localStorage.setItem(`quizScores_${selectedClass}`, JSON.stringify(scores));
}

// Modified updateScoreboard function without date field
function updateScoreboard() {
    const scoreboardBody = document.getElementById('scoreboardBody');
    scoreboardBody.innerHTML = '';

    let scores = JSON.parse(localStorage.getItem(`quizScores_${selectedClass}`)) || [];
    
    // Sort by score (highest first)
    scores.sort((a, b) => b.score - a.score);

    // Update scoreboard title to show current class
    const scoreboardTitle = document.querySelector('#scoreboard h2');
    scoreboardTitle.textContent = `${selectedClass} Scoreboard`;

    scores.forEach((score, index) => {
        const row = scoreboardBody.insertRow();
        
        // Rank
        row.insertCell(0).textContent = index + 1;
        
        // Name (capitalized)
        row.insertCell(1).textContent = score.name.toUpperCase();
        
        // Stream (keeping original case)
        row.insertCell(2).textContent = score.stream;
        
        // Score
        row.insertCell(3).textContent = score.score + '%';
    });

    document.getElementById('scoreboard').classList.remove('hidden');
}

// Modified showResult function to calculate score correctly
function showResult() {
    document.getElementById('processing').classList.add('hidden');
    const resultElement = document.getElementById('result');
    resultElement.classList.remove('hidden');
    
    resultElement.textContent = `${selectedName}, you got ${score} out of 100 marks! `;
    resultElement.classList.add('bounce');
    playSoundEffect('finish');

    // Show the button group when showing results
    toggleButtonGroup(true);

    saveScore(score);
    updateScoreboard();
}

function resetQuiz() {
    currentQuestion = 0;
    score = 0;
    selectedClass = '';
    selectedStream = '';
    selectedName = '';
    
    document.getElementById('scoreboard').classList.add('hidden');
    document.getElementById('result').classList.add('hidden');
    document.getElementById('quiz').classList.add('hidden');
    document.getElementById('playerSelection').classList.remove('hidden');
    
    // Show the button group when returning to selection screen
    toggleButtonGroup(true);
    
    document.getElementById('classSelect').value = '';
    document.getElementById('streamSelect').value = '';
    document.getElementById('nameSelect').value = '';
    
    document.getElementById('streamSelect').disabled = true;
    document.getElementById('nameSelect').disabled = true;
    
    const startQuizButton = document.getElementById('startQuiz');
    startQuizButton.disabled = true;
    startQuizButton.textContent = 'Start Quiz';
    startQuizButton.style.backgroundColor = '';
}

// Add function to reset attempts for a class (admin only)
function resetClassAttempts(className) {
    const adminPassword = prompt("Enter admin password to reset attempts:");
    if (adminPassword === "admin123") { // Replace with your secure password
        localStorage.removeItem(`quizScores_${className}`);
        alert(`All attempts for ${className} have been reset.`);
        resetQuiz();
    } else {
        alert("Incorrect admin password!");
    }
}

document.addEventListener('DOMContentLoaded', () => {
    initializeSelectors();
    
    const startQuizButton = document.getElementById('startQuiz');
    const playAgainButton = document.getElementById('playAgain');
    
    // Add admin reset button with a class for easier control
    const adminControls = document.createElement('div');
    adminControls.className = 'admin-controls'; // Add class for styling and selection
    adminControls.innerHTML = `
        <button id="adminReset" style="margin-top: 10px; background-color: #ff9800;">
            Clear Cache and Cookies 🚮
        </button>
    `;
    document.querySelector('.quiz-container').appendChild(adminControls);
   


    playAgainButton.addEventListener('click', resetQuiz);
    
    // Admin reset handler
    document.getElementById('adminReset').addEventListener('click', () => {
    if (selectedClass) {
        resetClassAttempts(selectedClass);
    } else {
        modal.show('error', 'Error', 'Please select a class first!', [
            { text: 'OK', type: 'primary' }
        ]);
    }
});
});

// Add to name selection handler in initializeSelectors
nameSelect.addEventListener('change', (e) => {
    selectedName = e.target.value;
    if (selectedName && hasUserAttemptedQuiz(selectedClass, selectedStream, selectedName)) {
        modal.show('info', 'Quiz Attempted', 
            `${selectedName} has already completed this quiz.`, [
                { text: 'OK', type: 'primary' }
            ]
        );
    }
    updateStartButton();
});
    </script>
</body>
</html>