<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICT Examination</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #fff3e0;
            color: #5d4037;
            padding-bottom: 40px;
        }
        .exam-paper {
            background-color: #ffffff;
            border-radius: 8px;
            padding: 40px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            font-size: 24px;
            margin: 0;
            color: #e65100;
        }
        .header p {
            margin: 5px 0;
            color: #ff6f00;
        }
        .student-info {
            margin-bottom: 30px;
            font-weight: bold;
        }
        .question {
            background-color: #ffe0b2;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .options label {
            display: block;
            margin-bottom: 10px;
        }
        button {
            display: block;
            width: 100%;
            padding: 12px;
            background-color: #ff9800;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 18px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #e65100;
        }
        .school-logo {
            max-width: 100px;
            margin: 0 auto 20px;
            display: block;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 500px;
            border-radius: 8px;
            text-align: center;
        }
        .modal-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #e65100;
        }
        .unanswered-list {
            text-align: left;
            margin: 20px 0;
            padding-left: 20px;
        }
        .modal-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        .modal-buttons button {
            width: 48%;
        }
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #4CAF50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
            z-index: 1000;
            display: none;
        }
        .progress-bar {
            width: 100%;
            height: 5px;
            background-color: #ddd;
            margin-top: 10px;
        }
        .progress {
            height: 100%;
            background-color: #4CAF50;
            width: 100%;
        }
        .timer {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #ff9800;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            font-size: 18px;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        .timer.warning {
            background-color: #f44336;
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(1.05); }
            100% { transform: translateX(-50%) scale(1); }
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #ff8c00;
            padding: 0.1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            width: 100%;
            z-index: 1000;
        }
        .navbar .logo {
            display: flex;
            align-items: center;
        }
        .navbar .logo img {
            width: 50px;
            height: auto;
            margin-right: 10px;
        }
        .navbar .logo .title {
            color: white;
            font-size: 1.8rem;
            font-weight: bold;
        }
        .navbar ul {
            list-style: none;
            display: flex;
            margin: 0;
            padding: 0;
        }
        .navbar ul li {
            margin-left: 1rem;
        }
        .navbar ul li a {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            display: block;
            transition: background-color 0.3s ease;
            font-size: 1.1rem;
            border-radius: 10px;
        }
        .navbar ul li a:hover {
            background-color: #e06b00;
        }
        .navbar .toggle {
            display: none;
            color: white;
            font-size: 1.8rem;
            cursor: pointer;
        }
        .logout-button {
            padding: 0.5rem 1rem;
            background-color: #ff8c00;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .logout-button:hover {
            background-color: #e06b00;
        }
        .flash-message {
            font-size: 24px;
            font-weight: bold;
            color: #FF4500;
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background-color: #FFE4B5;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            animation: flash-animation 1s infinite alternate, bounce 0.5s infinite alternate;
        }
        @keyframes flash-animation {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0.7; transform: scale(1.05); }
        }
        @keyframes bounce {
            0% { transform: translateY(0); }
            100% { transform: translateY(-5px); }
        }
        .footer {
            background-color: #ff8c00;
            color: white;
            text-align: center;
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            font-size: 0.8rem;
        }
        .container {
            margin-bottom: 40px;
        }
        @media (max-width: 600px) {
            .navbar ul {
                flex-direction: column;
                display: none;
                width: 100%;
            }
            .navbar ul li {
                margin-left: 0;
            }
            .navbar ul li a {
                text-align: center;
                padding: 1rem;
            }
            .navbar .toggle {
                display: block;
            }
            .navbar ul.show {
                display: flex;
            }
        }
        @keyframes colorChange {
            0% { color: white; }
            20% { color: #FFE0B2; }
            40% { color: #FFCC80; }
            60% { color: #FFA726; }
            80% { color: #FF9800; }
            100% { color: white; }
        }

        .animated-title {
            animation: colorChange 6s infinite;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body>
    <div class="navbar">
            <div class="logo">
                <img src="schoologo-2-150x150.png" alt="School Logo">
                <div class="title animated-title">Glorious Schools</div>
            </div>
        <span class="toggle" onclick="toggleMenu()">&#9776;</span>
        <ul id="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="javascript:void(0);" onclick="checkAuth('games.html')">Games</a></li>
            <li><a href="javascript:void(0);" onclick="checkAuth('videos.html')">Videos</a></li>     
            <li><a href="javascript:void(0);" onclick="checkAuth('library.html')">Library</a></li>
            <li id="logout-nav" style="display: none;"><button class="logout-button" onclick="logout()">Logout</button></li>
        </ul>
    </div>
    <div id="login-message" class="flash-message" style="display: none;">
        Access denied! You must first login to view this page üîê 
    </div>

    <footer class="footer">
        <p>&copy; Glorious Schools <span id="currentYear"></span></p>
    </footer>

    <div class="exam-paper">
        <div class="header">
            <img src="schoologo-2-150x150.png" alt="School Logo" class="school-logo">
            <h1>GLORIOUS KINDERGARTEN & PRIMARY SCHOOL</h1>
            <p>MID-TERM II EXAMINATION 2024</p>
            <p>INFORMATION AND COMMUNICATION TECHNOLOGY (ICT)</p>
        </div>
        <div class="student-info">
            <p>NAME: <span id="studentName"></span></p>
            <p>CLASS: <span id="studentClass"></span></p>
            <p>STREAM: <span id="studentStream"></span></p>
        </div>
        <div id="timer" class="timer">
            <span id="time">10:00</span>
        </div>
        <form id="quizForm">
            <div id="questions"></div>
            <button type="submit">Submit Examination</button>
        </form>
    </div>

    <div id="submitModal" class="modal">
        <div class="modal-content">
            <p class="modal-title">Are you sure you want to submit the exam?</p>
            <p id="modalText"></p>
            <ul id="unansweredList" class="unanswered-list"></ul>
            <div class="modal-buttons">
                <button id="confirmSubmit">SUBMIT üì§</button>
                <button id="returnToExam">CANCEL ‚ùå</button>
            </div>
        </div>
    </div>

    <div id="notification" class="notification">
        Your exam has been submitted successfully, returning back to homepage.
        <div class="progress-bar">
            <div class="progress" id="progress"></div>
        </div>
    </div>

    <footer class="footer">
        <p>&copy; Glorious Schools <span id="currentYear"></span></p>
    </footer>

    <script>
        function setCurrentYear() {
            const currentYear = new Date().getFullYear();
            document.getElementById('currentYear').textContent = currentYear;
        }

        function toggleMenu() {
            const navLinks = document.getElementById("nav-links");
            navLinks.classList.toggle("show");
        }

        function checkAuth(page) {
            if (localStorage.getItem('isLoggedIn') === 'true' || sessionStorage.getItem('isLoggedIn') === 'true') {
                window.location.href = page;
            } else {
                sessionStorage.setItem("intendedPage", page);
                showLoginMessage();
            }
        }

        function showLoginMessage() {
            document.getElementById("login-message").style.display = "block";
        }

        function checkAuthStatus() {
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true' || sessionStorage.getItem('isLoggedIn') === 'true';
            document.getElementById("logout-nav").style.display = isLoggedIn ? "block" : "none";
        }

        function logout() {
            localStorage.removeItem("rememberMe");
            localStorage.removeItem("email");
            localStorage.removeItem("password");
            localStorage.removeItem("isLoggedIn");
            sessionStorage.removeItem("email");
            sessionStorage.removeItem("password");
            sessionStorage.removeItem("isLoggedIn");
            sessionStorage.removeItem("intendedPage");
            window.location.href = 'index.html';
        }

        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            setCurrentYear();
        });

        // Populate student info
        document.getElementById('studentName').textContent = localStorage.getItem('studentName');
        document.getElementById('studentClass').textContent = localStorage.getItem('studentClass');
        document.getElementById('studentStream').textContent = localStorage.getItem('studentStream');

        const quizData = {
            'Primary Three': [
            {
                    question: "Define the term computer?",
                    options: ["A computer is something which looks like a TV", "A computer is an electronic device which stores and processes data into information.", "A computer is a thing which can do a lot of work.", "A computer is a machine which has a mouse and a keyboard."],
                    correctAnswer: 0
                },
            {
                    question: "Which part is considered the 'brain' of the computer?",
                    options: ["CPU", "Mouse", "Keyboard", "Monitor"],
                    correctAnswer: 0
                },                {
                    question: "Write ICT in full.",
                    options: ["Information and Computer Technology", "Information Communication Technology", "Information and Communication Technology", "Information Computer Technology"],
                    correctAnswer: 0
                },
                {
                    question: "Suggest any one importance of a monitor to the computer.",
                    options: ["A monitor helps the computer to see what the person is typing.", "A monitor is an electronic device which stores and processes data into information.", "A monitor helps a person to watch movies and play games.", "A monitor helps to display information to the user."],
                    correctAnswer: 0
                },
                {
                    question: "What do you understand by the term hardware?",
                    options: ["Hardware is a shop which sells building materials.", "Hardware is something which is so hard.", "Hardware are the parts of a computer which you can see and touch.", "Graphics Card"],
                    correctAnswer: 2
                },
                {
                    question: "Of what importance is a mouse on a computer?",
                    options: ["A mouse helps to scare away rats in the computer room.", "A mouse is used for playing music.", "A mouse is like the mouth of a computer.", "A mouse is used for selecting items on the screen."],
                    correctAnswer: 3
                },
                {
                    question: "State any one importance of a keyboard on a computer.",
                    options: ["To type information into the computer.", "To press it and it produces sound.", "A keyboard makes the computer to look beautiful.", "A keyboard helps the computer to know what the user is doing."],
                    correctAnswer: 0
                },
                {
                    question: "Give the meaning of the term software.",
                    options: ["Software are parts of a computer which you can see but not touch.", "Software means something very soft.", "Software are the soft parts on a computer.", "Software refers to parts of a computer which you can and touch but they are very soft."],
                    correctAnswer: 2
                },
                {
                    question: "State the short form of Central Processing Unit.",
                    options: ["CPU", "CEPRO", "CENTPRO", "CPUN"],
                    correctAnswer: 0
                },
                {
                    question: "Mention any one type of computer software.",
                    options: ["System software", "Computer software", "Monitor Software", "Mouse Software"],
                    correctAnswer: 0
                },
            ],
            'Primary Four': [
            {
                    question: "Define the term computer?",
                    options: ["A computer is something which looks like a TV", "A computer is an electronic device which stores and processes data into information.", "A computer is a thing which can do a lot of work.", "A computer is a machine which has a mouse and a keyboard."],
                    correctAnswers: [0, 1, 2, 3]
                },
            {
                    question: "What is information?",
                    options: ["Information is processed data which has meaning to the user.", "Information is the sending and receiving of messages.", "Data is unprocessed data which has meaning to the user.", "Data is unprocessed data which has no meaning to the user."],
                    correctAnswers: [0, 1, 2, 3]
                },
                {
                    question: "List down any two types of computer software",
                    options: ["Application Software", "Computer Software", "Hardware Software", "System Software", "Monitor", "Keyboard"],
                    correctAnswers: [0, 1, 2, 3]
                },
                {
                    question: "Give the meaning of the term software.",
                    options: ["Software are parts of a computer which you can see and but not touch.", "Software means somethings very soft.", "Software are the soft parts on a computer.", "Software refers to parts of a computer which you can see but touch but they are very soft."],
                    correctAnswers: [0, 1, 2, 3]
                },
                {
                    question: "State any two examples of output devices.",
                    options: ["Keyboard", "Mouse", "Monitor", "Printer", "Scanner", "Speakers"],
                    correctAnswers: [0, 1, 4]
                },
                {
                    question: "Mention any three examples of computer hardware.",
                    options: ["Mouse", "Buttons", "Keyboard", "Wires", "Monitor"],
                    correctAnswers: [0, 1, 2]
                },
                {
                    question: "List down any three examples of application software.",
                    options: ["Microsoft Word", "WhatsApp", "Linux", "Google Chrome", "Hardware"],
                    correctAnswers: [0, 1, 2, 3]
                },
                {
                    question: "Give the two components of a computer.",
                    options: ["Hard Drive", "Hardware", "Software", "DVD", "CPU"],
                    correctAnswers: [0, 1, 2, 3]
                },
                {
                    question: "List down any one example of input device you know.",
                    options: ["Keyboard", "Monitor", "CPU", "USB", "Wires", "Headphones"],
                    correctAnswers: [0, 1, 2, 3, 4, 5]
                },
                {
                    question: "What do you understand by the term data?",
                    options: ["Data is unprocessed information which has meaning to the user.", "Data is used to go to the internet.", "Data is unprocessed information which has no meaning to the user."],
                    correctAnswers: [0, 1, 2, 3, 4, 5]
                }
                ,
                {
                    question: "Write IT in full",
                    options: ["Information and Technology", "Information and Computer Technology", "Information Technology"],
                    correctAnswers: [0, 1, 2, 3, 4, 5]
                },
                {
                    question: "List down any two examples of system software.",
                    options: ["Windows", "Doors", "Linux", "Apple"],
                    correctAnswers: [0, 1, 2, 3]
                }
                
            ]
        };
    
        const questionsContainer = document.getElementById('questions');
const studentClass = localStorage.getItem('studentClass');

quizData[studentClass].forEach((q, index) => {
    const questionDiv = document.createElement('div');
    questionDiv.className = 'question';
    questionDiv.innerHTML = `
        <p>${index + 1}. ${q.question}</p>
        <div class="options">
            ${q.options.map((option, i) => `
                <label>
                    <input type="${studentClass === 'Primary Three' ? 'radio' : 'checkbox'}" 
                           name="q${index}" 
                           value="${i}">
                    ${option}
                </label>
            `).join('')}
        </div>
    `;
    questionsContainer.appendChild(questionDiv);
});

let examSubmitted = false;

let timeLeft = 10 * 60; // 10 minutes in seconds
const timerElement = document.getElementById('time');

function updateTimer() {
    const minutes = Math.floor(timeLeft / 60);
    let seconds = timeLeft % 60;
    seconds = seconds < 10 ? '0' + seconds : seconds;
    timerElement.textContent = `${minutes}:${seconds}`;
    
    if (timeLeft <= 60) { // Last minute
        document.getElementById('timer').classList.add('warning');
    }
    
    if (timeLeft <= 0) {
        clearInterval(timerInterval);
        autoSubmitExam();
    } else {
        timeLeft--;
    }
}

const timerInterval = setInterval(updateTimer, 1000);

function autoSubmitExam() {
    let answers = [];
    quizData[studentClass].forEach((q, index) => {
        if (studentClass === 'Primary Three') {
            const selected = document.querySelector(`input[name="q${index}"]:checked`);
            answers.push(selected ? selected.value : 'Not answered');
        } else {
            const selected = Array.from(document.querySelectorAll(`input[name="q${index}"]:checked`))
                                  .map(input => input.value);
            answers.push(selected.length > 0 ? selected : 'Not answered');
        }
    });

    submitExam(answers);
}

document.getElementById('quizForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    if (examSubmitted) {
        alert("You have already submitted this exam.");
        return;
    }

    let answers = [];
    let unansweredQuestions = [];
    quizData[studentClass].forEach((q, index) => {
        if (studentClass === 'Primary Three') {
            const selected = document.querySelector(`input[name="q${index}"]:checked`);
            if (!selected) {
                unansweredQuestions.push(index + 1);
            }
            answers.push(selected ? selected.value : 'Not answered');
        } else {
            const selected = Array.from(document.querySelectorAll(`input[name="q${index}"]:checked`))
                                  .map(input => input.value);
            if (selected.length === 0) {
                unansweredQuestions.push(index + 1);
            }
            answers.push(selected.length > 0 ? selected : 'Not answered');
        }
    });

    const modal = document.getElementById('submitModal');
    const modalText = document.getElementById('modalText');
    const unansweredList = document.getElementById('unansweredList');
    
    if (unansweredQuestions.length > 0) {
        modalText.textContent = 'The following questions were not answered:';
        unansweredList.innerHTML = unansweredQuestions.map(num => `<li>Question ${num}</li>`).join('');
    } else {
        modalText.textContent = 'All questions have been answered successfully.';
        unansweredList.innerHTML = '';
    }

    modal.style.display = 'block';

    document.getElementById('confirmSubmit').onclick = function() {
        modal.style.display = 'none';
        submitExam(answers);
    };

    document.getElementById('returnToExam').onclick = function() {
        modal.style.display = 'none';
    };
});

function submitExam(answers) {
    if (examSubmitted) {
        return; // Prevent multiple submissions
    }
    examSubmitted = true;

    const headerContent = `
               GLORIOUS KINDERGARTEN & PRIMARY SCHOOL
                MID-TERM II EXAMINATION 2024
       INFORMATION AND COMMUNICATION TECHNOLOGY (ICT)

NAME: ${localStorage.getItem('studentName')}
CLASS: ${studentClass}
STREAM: ${localStorage.getItem('studentStream')}

`;

    const offlineContent = headerContent + quizData[studentClass].map((q, index) => {
        let answerText;
        if (studentClass === 'Primary Three') {
            answerText = answers[index] === 'Not answered' ? 'Not answered' : q.options[answers[index]];
        } else {
            answerText = answers[index] === 'Not answered' ? 'Not answered' : 
                         answers[index].map(ans => q.options[ans]).join('\n');
        }
        return `
${index + 1}. ${q.question}
${answerText}

`;
    }).join('\n');

    const blob = new Blob([offlineContent], {type: 'text/plain'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    
    const studentName = localStorage.getItem('studentName');
    const safeFileName = studentName.replace(/[<>:"/\\|?*]/g, '');
    a.download = `${safeFileName}.txt`;
    
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);

    // Show notification
    const notification = document.getElementById('notification');
    const progress = document.getElementById('progress');
    notification.style.display = 'block';

    let width = 100;
    const interval = setInterval(function() {
        if (width <= 0) {
            clearInterval(interval);
            notification.style.display = 'none';
            window.location.href = 'examinations.html';
        } else {
            width -= 2;
            progress.style.width = width + '%';
        }
    }, 100);
}
function toggleMenu() {
            const navLinks = document.getElementById('nav-links');
            navLinks.classList.toggle('active');
        }

        function setCurrentYear() {
            const currentYear = new Date().getFullYear();
            document.getElementById('currentYear').textContent = currentYear;
        }

        function checkAuth(page) {
            if (localStorage.getItem('isLoggedIn') === 'true' || sessionStorage.getItem('isLoggedIn') === 'true') {
                window.location.href = page;
            } else {
                sessionStorage.setItem("intendedPage", page);
                showLoginMessage();
            }
        }

        function showLoginMessage() {
            document.getElementById("login-message").style.display = "block";
        }

        function checkAuthStatus() {
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true' || sessionStorage.getItem('isLoggedIn') === 'true';
            document.getElementById("logout-nav").style.display = isLoggedIn ? "block" : "none";
        }

        function logout() {
            localStorage.removeItem("rememberMe");
            localStorage.removeItem("email");
            localStorage.removeItem("password");
            localStorage.removeItem("isLoggedIn");
            sessionStorage.removeItem("email");
            sessionStorage.removeItem("password");
            sessionStorage.removeItem("isLoggedIn");
            sessionStorage.removeItem("intendedPage");
            window.location.href = 'index.html';
        }

        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            setCurrentYear();
        });
    
    </script>
</body>
</html>
